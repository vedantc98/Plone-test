
/* reset requirejs definitions so that people who
   put requirejs in legacy compilation do not get errors */
var _old_define = define;
var _old_require = require;
define = undefined;
require = undefined;
try{

/* resource: ++resource++plone.app.discussion.javascripts/comments.js */
if(require===undefined)require=function(reqs,torun){'use strict';return torun(window.jQuery);};require(['jquery'],function($){'use strict';$.createReplyForm=function(comment_div){var comment_id=comment_div.attr('id');var reply_button=comment_div.find('.reply-to-comment-button');var reply_div=$('#commenting').clone(true);reply_div.find('#formfield-form-widgets-captcha').find('script').remove();reply_div.appendTo(comment_div).css('display','none');reply_div.removeAttr('id');$(reply_button).css('display','none');var reply_form=reply_div.find('form');reply_form.find('#formfield-form-widgets-comment-text').attr('id','formfield-form-widgets-new-textarea'+comment_id);reply_form.find('#form-widgets-comment-text').attr('id','form-widgets-new-textarea'+comment_id);reply_form.find('input[name="form.widgets.in_reply_to"]').val(comment_id);var cancel_reply_button=reply_div.find('.cancelreplytocomment');cancel_reply_button.attr('id',comment_id);reply_form.find('input[name="form.buttons.cancel"]').css('display','inline');reply_div.slideDown('slow');cancel_reply_button.css('display','inline');};$.clearForm=function(form_div){form_div.find('.error').removeClass('error');form_div.find('.fieldErrorBox').remove();form_div.find('input[type="text"]').attr('value','');form_div.find('textarea').attr('value','');};$(window).load(function(){var post_comment_div=$('#commenting');var in_reply_to_field=post_comment_div.find('input[name="form.widgets.in_reply_to"]');if(in_reply_to_field.length!==0&&in_reply_to_field.val()!==''){var current_reply_id='#'+in_reply_to_field.val();var current_reply_to_div=$('.discussion').find(current_reply_id);$.createReplyForm(current_reply_to_div);$.clearForm(post_comment_div);}$('.reply-to-comment-button').bind('click',function(e){var comment_div=$(this).parents().filter('.comment');$.createReplyForm(comment_div);$.clearForm(comment_div);});$('#commenting #form-buttons-cancel').bind('click',function(e){e.preventDefault();var reply_to_comment_button=$(this).parents().filter('.comment').find('.reply-to-comment-button');$.reply_to_comment_form=$(this).parents().filter('.reply');$.reply_to_comment_form.slideUp('slow',function(){$(this).remove();});reply_to_comment_button.css('display','inline');});$('input[name="form.button.PublishComment"]').on('click',function(){var trigger=this;var form=$(this).parents('form');var data=$(form).serialize();var form_url=$(form).attr('action');$.ajax({type:'GET',url:form_url,data:data,context:trigger,success:function(msg){form.find('input[name="form.button.PublishComment"]').remove();form.parents('.state-pending').toggleClass('state-pending').toggleClass('state-published');},error:function(msg){return true;}});return false;});if($.fn.prepOverlay)$('form[name="edit"]').prepOverlay({cssclass:'overlay-edit-comment',width:'60%',subtype:'ajax',filter:'#content>*'});$('input[name="form.button.DeleteComment"]').on('click',function(){var trigger=this;var form=$(this).parents('form');var data=$(form).serialize();var form_url=$(form).attr('action');$.ajax({type:'POST',url:form_url,data:data,context:$(trigger).parents('.comment'),success:function(data){var comment=$(this);var clss=comment.attr('class');var treelevel=parseInt(clss[clss.indexOf('replyTreeLevel')+'replyTreeLevel'.length],10);var selector='.replyTreeLevel'+treelevel;for(var i=0;i<treelevel;i++)selector+=', .replyTreeLevel'+i;comment.nextUntil(selector).each(function(){$(this).fadeOut('fast',function(){$(this).remove();});});var parent=comment.prev('[class*="replyTreeLevel'+(treelevel-1)+'"]');parent.find('form[name="delete"]').css('display','inline');$(this).fadeOut('fast',function(){$(this).remove();});},error:function(req,error){return true;}});return false;});$('.reply').find('input[name="form.buttons.reply"]').css('display','none');$('.reply').find('input[name="form.buttons.cancel"]').css('display','none');$('.reply-to-comment-button').removeClass('hide');});});
/* resource: jquery.highlightsearchterms.js */
(function($){var Highlighter,makeSearchKey,makeAddress,defaults;Highlighter=function(options){$.extend(this,options);this.terms=this.cleanTerms(this.terms.length?this.terms:this.getSearchTerms());};Highlighter.prototype={highlight:function(startnode){if(!this.terms.length||!startnode.length)return;var self=this;$.each(this.terms,function(i,term){startnode.find('*:not(textarea)').andSelf().contents().each(function(){if(this.nodeType===3)self.highlightTermInNode(this,term);});});},highlightTermInNode:function(node,word){var c=node.nodeValue,self=this,highlight,ci,index,next;if($(node).parent().hasClass(self.highlightClass))return;highlight=function(content){return $('<span class="'+self.highlightClass+'">&nbsp;</span>').text(content);};ci=self.caseInsensitive;while(c&&(index=(ci?c.toLowerCase():c).indexOf(word))>-1){$(node).before(document.createTextNode(c.substr(0,index))).before(highlight(c.substr(index,word.length))).before(document.createTextNode(c.substr(index+word.length)));next=node.previousSibling;$(node).remove();node=next;c=node.nodeValue;}},queryStringValue:function(uri,regexp){var match,pair;if(uri.indexOf('?')<0)return '';uri=uri.substr(uri.indexOf('?')+1);while(uri.indexOf('=')>=0){uri=uri.replace(/^\&*/,'');pair=uri.split('&',1)[0];uri=uri.substr(pair.length);match=pair.match(regexp);if(match)return decodeURIComponent(match[match.length-1].replace(/\+/g,' '));}return '';},termsFromReferrer:function(){var ref,i,se;ref=$.fn.highlightSearchTerms._test_referrer!==null?$.fn.highlightSearchTerms._test_referrer:document.referrer;if(!ref)return '';for(i=0;i<this.referrers.length;i+=1){se=this.referrers[i];if(ref.match(se.address))return this.queryStringValue(ref,se.key);}return '';},cleanTerms:function(terms){var self=this;return $.unique($.map(terms,function(term){term=$.trim(self.caseInsensitive?term.toLowerCase():term);return(!term||self.filterTerms.test(term))?null:term;}));},getSearchTerms:function(){var terms=[],uri=$.fn.highlightSearchTerms._test_location!==null?$.fn.highlightSearchTerms._test_location:location.href;if(this.useReferrer)$.merge(terms,this.termsFromReferrer().split(/\s+/));if(this.useLocation)$.merge(terms,this.queryStringValue(uri,this.searchKey).split(/\s+/));return terms;}};makeSearchKey=function(key){return(typeof key==='string')?new RegExp('^'+key+'=(.*)$','i'):key;};makeAddress=function(addr){return(typeof addr==='string')?new RegExp('^https?://(www\\.)?'+addr,'i'):addr;};$.fn.highlightSearchTerms=function(options){options=$.extend({},defaults,options);options=$.extend(options,{searchKey:makeSearchKey(options.searchKey),referrers:$.map(options.referrers,function(se){return{address:makeAddress(se.address),key:makeSearchKey(se.key)};})});if(options.includeOwnDomain){var hostname=$.fn.highlightSearchTerms._test_location!==null?$.fn.highlightSearchTerms._test_location:location.hostname;options.referrers.push({address:makeAddress(hostname.replace(/\./g,'\\.')),key:options.searchKey});}new Highlighter(options).highlight(this);return this;};$.fn.highlightSearchTerms.referrers=[{address:'google\\.',key:'q'},{address:'search\\.yahoo\\.',key:'p'},{address:'search\\.msn\\.',key:'q'},{address:'search\\.live\\.',key:'query'},{address:'search\\.aol\\.',key:'userQuery'},{address:'ask\\.com',key:'q'},{address:'altavista\\.',key:'q'},{address:'feedster\\.',key:'q'}];defaults={terms:[],useLocation:true,searchKey:'(searchterm|SearchableText)',useReferrer:true,referrers:$.fn.highlightSearchTerms.referrers,includeOwnDomain:true,caseInsensitive:true,filterTerms:/(not|and|or)/i,highlightClass:'highlightedSearchTerm'};$.fn.highlightSearchTerms._test_location=null;$.fn.highlightSearchTerms._test_referrer=null;$.fn.highlightSearchTerms._highlighter=Highlighter;}(jQuery));jQuery(function($){$('#region-content,#content').highlightSearchTerms({includeOwnDomain:$('dl.searchResults').length===0});});
/* resource: ++resource++plone.app.event/event.js */
(function($){var eventedit={start_end_delta:1/24,$start_input:undefined,$start_container:undefined,$pickadate_starttime:undefined,$end_input:undefined,$end_container:undefined,$pickadate_endtime:undefined,$whole_day_input:undefined,$open_end_input:undefined,get_dom_element:function(sel,$container){var $el;if($container)$el=$(sel,$container);else $el=$(sel);return $el.length?$el:undefined;},getDateTime:function(datetimewidget){var date,time,datetime,set_time;date=$('input[name="_submit"]:first',datetimewidget).prop('value');if(!date)return;date=date.split('-');time=$('input[name="_submit"]:last',datetimewidget).prop('value');if(!time){set_time=true;time='00:00';}time=time.split(':');datetime=new Date(parseInt(date[0],10),parseInt(date[1],10)-1,parseInt(date[2],10),parseInt(time[0],10),parseInt(time[1],10));if(set_time)$('.pattern-pickadate-time',datetimewidget).pickatime('picker').set('select',datetime);return datetime;},initStartEndDelta:function(start_container,end_container){var start_datetime=this.getDateTime(start_container);var end_datetime=this.getDateTime(end_container);if(!start_datetime||!end_datetime)return;this.start_end_delta=(end_datetime-start_datetime)/1000/60;},updateEndDate:function(start_container,end_container){var start_date=this.getDateTime(start_container);if(!start_date)return;var new_end_date=new Date(start_date);new_end_date.setMinutes(start_date.getMinutes()+this.start_end_delta);$('.pattern-pickadate-date',end_container).pickadate('picker').set('select',new_end_date);$('.pattern-pickadate-time',end_container).pickatime('picker').set('select',new_end_date);},validateEndDate:function(start_container,end_container){var start_datetime=this.getDateTime(start_container);var end_datetime=this.getDateTime(end_container);if(!start_datetime||!end_datetime)return;if(end_datetime<start_datetime)start_container.addClass('error');else end_container.removeClass('error');},show_hide_widget:function(widget,hide,fade){var $widget=$(widget);if(hide===true)if(fade===true)$widget.fadeOut();else $widget.hide();else if(fade===true)$widget.fadeIn();else $widget.show();},event_listing_calendar_init:function(cal){if($().dateinput&&cal.length>0){var get_req_param,val;get_req_param=function(name){if(name===new RegExp('[?&]'+encodeURIComponent(name)+'=([^&]*)').exec(window.location.search))return decodeURIComponent(name[1]);};val=get_req_param('date');if(val===undefined)val=new Date();else val=new Date(val);cal.dateinput({selectors:true,trigger:true,format:'yyyy-mm-dd',yearRange:[-10,10],firstDay:1,value:val,change:function(){var value=this.getValue('yyyy-mm-dd');window.location.href='event_listing?mode=day&date='+value;}}).unbind('change').bind('onShow',function(){var trigger_offset=$(this).next().offset();$(this).data('dateinput').getCalendar().offset({top:trigger_offset.top+20,left:trigger_offset.left});});}},initilize_event:function(){var $start_container=this.$start_container,$end_container=this.$end_container,$pickadate_starttime=this.$pickadate_starttime,$pickadate_endtime=this.$pickadate_endtime,$open_end_input=this.$open_end_input,$whole_day_input=this.$whole_day_input;if($whole_day_input.length>0){$whole_day_input.bind('change',function(e){this.show_hide_widget($pickadate_starttime,e.target.checked,true);this.show_hide_widget($pickadate_endtime,e.target.checked,true);}.bind(this));this.show_hide_widget($pickadate_starttime,$whole_day_input.get(0).checked,false);this.show_hide_widget($pickadate_endtime,$whole_day_input.get(0).checked,false);}if($open_end_input.length>0){$open_end_input.bind('change',function(e){this.show_hide_widget($end_container,e.target.checked,true);}.bind(this));this.show_hide_widget($end_container,$open_end_input.get(0).checked,false);}$start_container.on('focus','.picker__input',function(){this.initStartEndDelta($start_container,$end_container);}.bind(this));$start_container.on('change','.picker__input',function(){this.updateEndDate($start_container,$end_container);}.bind(this));$end_container.on('focus','.picker__input',function(){this.initStartEndDelta($start_container,$end_container);}.bind(this));$end_container.on('change','.picker__input',function(){this.validateEndDate($start_container,$end_container);}.bind(this));}};$(document).ready(function(){eventedit.$start_input=eventedit.get_dom_element('form input.event_start');if(!eventedit.$start_input)return;eventedit.$end_input=eventedit.get_dom_element('form input.event_end');if(!eventedit.$end_input)return;eventedit.$start_container=eventedit.$start_input.closest('div');eventedit.$end_container=eventedit.$end_input.closest('div');eventedit.$whole_day_input=eventedit.get_dom_element('form input.event_whole_day');eventedit.$open_end_input=eventedit.get_dom_element('form input.event_open_end');var interval=setInterval(function(){eventedit.$pickadate_starttime=!eventedit.$pickadate_starttime&&eventedit.get_dom_element('.pattern-pickadate-time-wrapper',eventedit.$start_container);eventedit.$pickadate_endtime=!eventedit.$pickadate_endtime&&eventedit.get_dom_element('.pattern-pickadate-time-wrapper',eventedit.$end_container);if(eventedit.$pickadate_starttime&&eventedit.$pickadate_endtime){clearInterval(interval);eventedit.initilize_event();}},100);eventedit.event_listing_calendar_init($('#event_listing_calendar'));});})(jQuery);
}catch(e){
    // log it
    if (typeof console !== "undefined"){
        console.log('Error loading javascripts!' + e);
    }
}finally{
    define = _old_define;
    require = _old_require;
}
